<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        .card {
            background-color: #111827;
            border-radius: 12px;
            padding: 20px;
            color: white;
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            height: 160px;
            box-sizing: border-box;
            z-index: 1;
        }
        
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        /* New class for the third row with only 2 habits */
        .row3 {
            grid-column: span 2;
        }
        
        .perfect-day-container {
            position: relative;
            padding: 6px;
            margin-bottom: 5px;
            border-radius: 18px;
        }
        
        .perfect-day-frame {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            border-radius: 18px;
            z-index: 0;
            pointer-events: none;
            border: 4px solid;
            border-image-slice: 1;
            border-image-source: linear-gradient(90deg, 
                rgb(253, 29, 141) 0%,
                rgb(147, 51, 234) 33%,
                rgb(55, 252, 225) 66%,
                rgb(253, 29, 141) 100%
            );
            background-size: 300% 100%;
            animation: moveBorder 6s linear infinite;
        }
        
        @keyframes moveBorder {
            0% {
                border-image-source: linear-gradient(90deg, 
                    rgb(253, 29, 141) 0%,
                    rgb(147, 51, 234) 33%,
                    rgb(55, 252, 225) 66%,
                    rgb(253, 29, 141) 100%
                );
            }
            25% {
                border-image-source: linear-gradient(90deg, 
                    rgb(147, 51, 234) 0%,
                    rgb(55, 252, 225) 33%,
                    rgb(253, 29, 141) 66%,
                    rgb(147, 51, 234) 100%
                );
            }
            50% {
                border-image-source: linear-gradient(90deg, 
                    rgb(55, 252, 225) 0%,
                    rgb(253, 29, 141) 33%,
                    rgb(147, 51, 234) 66%,
                    rgb(55, 252, 225) 100%
                );
            }
            75% {
                border-image-source: linear-gradient(90deg, 
                    rgb(253, 29, 141) 33%,
                    rgb(147, 51, 234) 66%,
                    rgb(55, 252, 225) 100%,
                    rgb(253, 29, 141) 0%
                );
            }
            100% {
                border-image-source: linear-gradient(90deg, 
                    rgb(253, 29, 141) 0%,
                    rgb(147, 51, 234) 33%,
                    rgb(55, 252, 225) 66%,
                    rgb(253, 29, 141) 100%
                );
            }
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .emoji {
            font-size: 28px;
            margin-right: 16px;
            line-height: 1;
        }
        
        .habit-name {
            font-size: 20px;
            font-weight: 600;
            margin: 0;
        }
        
        .card-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        
        .streak-box {
            display: flex;
            flex-direction: column;
        }
        
        .streak-label {
            font-size: 14px;
            color: #9ca3af;
            margin-bottom: 6px;
            margin-top: 0;
        }
        
        .streak-value {
            font-size: 28px;
            font-weight: 700;
            line-height: 1.2;
            margin: 0 0 6px 0;
        }
        
        .streak-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .record-breaking {
            color: #c084fc;
        }
        
        .active {
            color: #4ade80;
        }
        
        .inactive {
            color: #9ca3af;
        }
        
        .best {
            color: #9ca3af;
        }
        
        .perfect-day-message {
            text-align: center;
            margin-top: 10px;
            font-size: 18px;
            font-weight: bold;
            color: #c084fc;
            line-height: 1.4;
        }
        
        .perfect-day-submessage {
            text-align: center;
            margin-top: 5px;
            font-size: 14px;
            color: #9ca3af;
            font-style: italic;
        }
        
        .active-background {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            opacity: 0.25;
            background-color: #0aa342;
            z-index: -1;
            border-radius: 12px;
            width: 100%;
            height: 100%;
        }
        
        .record-background {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            opacity: 0.3;
            z-index: -1;
            border-radius: 12px;
            width: 100%;
            height: 100%;
            background: radial-gradient(
                circle at center,
                rgb(253, 29, 141) 0%,
                rgb(147, 51, 234) 35%,
                rgb(55, 252, 225) 70%,
                transparent 100%
            );
            background-size: 200% 200%;
            animation: moveGradient 6s ease-in-out infinite;
        }
        
        @keyframes moveGradient {
            0% {
                background-position: 0% 0%;
            }
            50% {
                background-position: 100% 100%;
            }
            100% {
                background-position: 0% 0%;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/javascript">
        // Get habits data from Streamlit
        const habitsData = HABITS_DATA_PLACEHOLDER;
        
        // Create the root container
        const rootElement = document.getElementById('root');
        
        // Create two habit grids - one for rows 1 and 2, and another for row 3
        const habitGrid1And2 = document.createElement('div');
        habitGrid1And2.className = 'grid-container';
        
        const habitGrid3 = document.createElement('div');
        habitGrid3.className = 'grid-container';
        
        // Check if all 8 habits are completed today (perfect day)
        const completedTodayCount = habitsData.filter(habit => habit.completedToday === "true").length;
        const isPerfectDay = completedTodayCount === 8;
        
        // Create container for the grid (for perfect day frame)
        let containerElement;
        if (isPerfectDay) {
            containerElement = document.createElement('div');
            containerElement.className = 'perfect-day-container';
            
            const frameElement = document.createElement('div');
            frameElement.className = 'perfect-day-frame';
            containerElement.appendChild(frameElement);
            rootElement.appendChild(containerElement);
            
            // Add the habit grids inside the container
            containerElement.appendChild(habitGrid1And2);
            containerElement.appendChild(habitGrid3);
        } else {
            // If not a perfect day, add the grids directly to root
            rootElement.appendChild(habitGrid1And2);
            rootElement.appendChild(habitGrid3);
        }
        
        // Create each habit card and place in appropriate grid
        habitsData.forEach((habit, index) => {
            const isRecordBreaking = habit.currentStreak >= habit.bestStreak && habit.currentStreak > 0;
            const isActive = habit.currentStreak > 0;
            
            const card = document.createElement('div');
            card.className = 'card';
            
            // Create background element based on streak status and today's completion
            let background = null;
            // Only show colored background if the habit was completed today
            if (habit.completedToday === "true") {
                if (isRecordBreaking) {
                    background = document.createElement('div');
                    background.className = 'record-background';
                } else if (isActive) {
                    background = document.createElement('div');
                    background.className = 'active-background';
                }
            }
            
            // Add background first so it's behind other elements
            if (background) {
                card.appendChild(background);
            }
            
            // Card header with emoji and name
            const header = document.createElement('div');
            header.className = 'card-header';
            
            const emoji = document.createElement('span');
            emoji.className = 'emoji';
            emoji.textContent = habit.emoji;
            
            const name = document.createElement('h3');
            name.className = 'habit-name';
            name.textContent = habit.name;
            
            header.appendChild(emoji);
            header.appendChild(name);
            card.appendChild(header);
            
            // Card content with streak info
            const content = document.createElement('div');
            content.className = 'card-content';
            
            // Current streak section
            const currentStreakBox = document.createElement('div');
            currentStreakBox.className = 'streak-box';
            
            const currentLabel = document.createElement('p');
            currentLabel.className = 'streak-label';
            currentLabel.textContent = 'Current streak';
            
            const currentValue = document.createElement('p');
            currentValue.className = 'streak-value';
            currentValue.textContent = habit.currentStreak + 'd';
            
            const currentStatus = document.createElement('div');
            currentStatus.className = isRecordBreaking ? 
                'streak-status record-breaking' : 
                (isActive ? 'streak-status active' : 'streak-status inactive');
            
            const statusText = document.createElement('span');
            statusText.textContent = isRecordBreaking ? 'Record-breaking' : (isActive ? 'Active' : 'Inactive');
            
            const statusIcon = document.createElement('i');
            // Use Font Awesome icons instead of emojis
            if (isRecordBreaking) {
                statusIcon.className = 'fa-solid fa-star';
            } else if (isActive) {
                statusIcon.className = 'fa-solid fa-fire';
            }
            
            currentStatus.appendChild(statusText);
            currentStatus.appendChild(statusIcon);
            
            currentStreakBox.appendChild(currentLabel);
            currentStreakBox.appendChild(currentValue);
            currentStreakBox.appendChild(currentStatus);
            
            // Best streak section
            const bestStreakBox = document.createElement('div');
            bestStreakBox.className = 'streak-box';
            
            const bestLabel = document.createElement('p');
            bestLabel.className = 'streak-label';
            bestLabel.textContent = 'Best streak';
            
            const bestValue = document.createElement('p');
            bestValue.className = 'streak-value';
            bestValue.textContent = habit.bestStreak + 'd';
            
            const bestStatus = document.createElement('div');
            bestStatus.className = 'streak-status best';
            
            const bestText = document.createElement('span');
            bestText.textContent = 'Best';
            
            const bestIcon = document.createElement('i');
            bestIcon.className = 'fa-solid fa-trophy';
            
            bestStatus.appendChild(bestText);
            bestStatus.appendChild(bestIcon);
            
            bestStreakBox.appendChild(bestLabel);
            bestStreakBox.appendChild(bestValue);
            bestStreakBox.appendChild(bestStatus);
            
            content.appendChild(currentStreakBox);
            content.appendChild(bestStreakBox);
            card.appendChild(content);
            
            // Determine which grid to add the card to
            if (index < 6) {
                // First 6 habits (rows 1 and 2) go in the first grid
                habitGrid1And2.appendChild(card);
            } else {
                // Last 2 habits (row 3) go in the second grid
                habitGrid3.appendChild(card);
            }
        });
        
        // Add a celebratory message for perfect days
        if (isPerfectDay) {
            const celebrationMsg = document.createElement('div');
            celebrationMsg.className = 'perfect-day-message';
            celebrationMsg.innerHTML = '<i class="fa-solid fa-medal"></i> Perfect Day! <i class="fa-solid fa-medal"></i>';
            rootElement.appendChild(celebrationMsg);
            
            const subMessage = document.createElement('div');
            subMessage.className = 'perfect-day-submessage';
            subMessage.textContent = 'All habits completed. Rest & conquer the next day.';
            rootElement.appendChild(subMessage);
        }
    </script>
</body>
</html>